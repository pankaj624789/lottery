<!DOCTYPE html>
<html>
<head>
  <link rel="icon" type="image/x-icon" href="https://raw.githubusercontent.com/pankaj624789/image/refs/heads/main/favicon.ico">
  <title>üéØ Lucky Draw -CRI</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: rgba(226, 199, 241, 1) url('https://github.com/pankaj624789/image/blob/main/fsimage.png?raw=true') no-repeat top left;
      padding: 30px;
    }

h1 {
  font-family: 'Poppins', sans-serif;
  font-size: 80px;
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 2px;
  color: white; /* plain white text */
  -webkit-text-stroke: 2px black; /* black text border */
  text-shadow: 4px 4px 15px rgba(224, 240, 7, 0.616),
               0 0 25px rgba(7, 63, 248, 0.842),
               0 0 40px rgba(6, 49, 236, 0.7);
  animation: glow 3s infinite alternate ease-in-out;
}

@keyframes glow {
  0% {
    text-shadow: 2px 2px 10px rgba(255, 186, 8, 0.6),
                 0 0 20px rgba(63, 50, 243, 0.849),
                 0 0 40px rgba(56, 6, 240, 0.5);
  }
  100% {
    text-shadow: 4px 4px 20px rgba(24, 6, 6, 0.8),
                 0 0 30px rgba(201, 205, 243, 0.9),
                 0 0 50px rgb(53, 2, 68);
  }
}



    button {
      background: linear-gradient(135deg, #0072ff, #00c6ff);
      color:white; border:none; padding:10px 20px; border-radius:8px;
      cursor:pointer; font-size:16px; margin:5px; transition:0.3s;
    }
    button:hover { background: linear-gradient(135deg, #00c6ff, #0072ff); }

    /* Wheel container */
    #wheel {
      margin: 20px auto;
      width: 90%;
      height: 60px;
      border: 3px solid #0078d7;
      border-radius: 15px;
      overflow: hidden;
      position: relative;
      background: #fff;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    #wheelItems {
      position: absolute;
      white-space: nowrap;
      font-size: 16px;
      font-weight: bold;
      line-height: 60px;
      left: 0;
      transition: left 0.5s ease-out;
    }

    #wheelItems span {
      display: inline-block;
      width: 300px;
      text-align: center;
      border-right: 2px solid #fff;
      border-radius: 10px;
      padding: 0 5px;
      color: white;
      font-weight: bold;
    }

    /* Colorful segments */
    .color1 { background: #FF5733; }
    .color2 { background: #33C1FF; }
    .color3 { background: #33FF57; }
    .color4 { background: #FF33D1; }
    .color5 { background: #FFC733; }

    /* Winner List */
    #winnerList {
      max-width: 90%;
      margin: 20px auto;
      background: #fff7a1;
      border: 2px solid #ffbf00;
      border-radius: 10px;
      padding: 15px;
      text-align: left;
      font-size: 16px;
      min-height: 50px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    #winnerList h2 { margin-top:0; color:#b45f00; }
    #winnerList ul { list-style:none; padding-left:0; }
    #winnerList li { margin:5px 0; border-bottom:1px dashed #ffbf00; padding:3px 0; }

    textarea {
      width: 90%; height: 120px; padding: 10px;
      border-radius: 8px; border:1px solid #ccc; font-family: monospace;
      margin-top: 15px;
    }

    .btn-group {
      margin: 15px 0;
    }

    /* üéâ Winner Celebration */
    #winnerCelebration {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 999;
      animation: fadeIn 0.5s ease-in;
    }

    #winnerCelebration.hidden {
      display: none;
    }

#winnerName {
  font-size: 4rem;
  font-weight: 900;
  background: linear-gradient(90deg, #FFD700, #FF8C00, #0457f1);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  -webkit-text-stroke: 2px #0011ff; /* Dark blue text border */
  text-shadow: 
      0 0 10px #FFD700,
      0 0 20px #FF8C00,
      0 0 30px #FF4500,
      0 0 40px rgba(255, 255, 0, 0.6);
  animation: pop 1.2s ease-out;
}



    .confetti {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      overflow: hidden;
    }

    @keyframes fadeIn {
      from {opacity: 0;}
      to {opacity: 1;}
    }

    @keyframes pop {
      0% { transform: scale(0.2) rotate(-20deg); opacity: 0; }
      60% { transform: scale(1.2) rotate(10deg); opacity: 1; }
      100% { transform: scale(1) rotate(0); }
    }
  </style>
</head>
<body>

<h1>CRI DHANTERAS & DIWALI DHAMAKA - 2025</h1>

<!-- Wheel -->
<div id="wheel">
  <div id="wheelItems"></div>
</div>

<!-- Spin Wheel button below the wheel -->
<div class="btn-group">
  <button onclick="spinWheel()">üéØ Spin Wheel</button>
</div>

<!-- Winner List -->
<div id="winnerList">
  <h2>üèÜ Winner List</h2>
  <ul id="winnerUl"></ul>
</div>

<!-- Other buttons below Winner List -->
<div class="btn-group">
  <button onclick="loadWheel()">Load Wheel</button>
  <button onclick="resetAll()">üîÅ Reset</button>
  <button onclick="downloadWinners()">üì• Download Winners</button>
</div>

<!-- Winner Celebration -->
<div id="winnerCelebration" class="hidden">
  <h1 id="winnerName"></h1>
  <div class="confetti"></div>
</div>

<!-- Paste area -->
<p>üìã Copy 4 columns from Excel (ID, Name, Dept, Location) and paste here:</p>
<textarea id="pasteBox" placeholder="Paste directly from Excel"></textarea><br>

<script>
  let participants = [];
  let winners = [];
  let spinning = false;

  function loadWheel() {
    const text = document.getElementById("pasteBox").value.trim();
    if (!text) { alert("Paste some data from Excel!"); return; }

    const rows = text.split(/\r?\n/);
    participants = rows.map(row => {
      const cols = row.split(/\t/);
      return { id: cols[0]||"", name: cols[1]||"", dept: cols[2]||"", location: cols[3]||"" };
    }).filter(p => p.name);

    if (participants.length === 0) { alert("No valid data!"); return; }

    renderWheel();
    document.getElementById("winnerUl").innerHTML = "";
    winners = [];
  }

  function renderWheel() {
    const wheelItems = document.getElementById("wheelItems");
    

    participants.forEach((p, i) => {
      const span = document.createElement("span");
      span.textContent = `${p.id}`;
      const colorClass = `color${(i % 5) + 1}`;
      span.classList.add(colorClass);
      wheelItems.appendChild(span);
    });
  }

  function spinWheel() {
    if (participants.length === 0) { alert("Load the wheel first!"); return; }
    if (spinning) return;
    spinning = true;

    const wheelItems = document.getElementById("wheelItems");
    let spins = 20 + Math.floor(Math.random() * 10);
    let i = 0;

    const interval = setInterval(() => {
      wheelItems.appendChild(wheelItems.firstChild.cloneNode(true));
      wheelItems.removeChild(wheelItems.firstChild);
      i++;

      if (i >= spins) {
        clearInterval(interval);
        const winnerIndex = Math.floor(Math.random() * participants.length);
        const winner = participants[winnerIndex];

        const drawNumber = winners.length + 1;
        const ul = document.getElementById("winnerUl");
        const li = document.createElement("li");
        li.textContent = `Draw ${drawNumber}: ${winner.id} | ${winner.name} | ${winner.dept} | ${winner.location}`;
        ul.prepend(li);

        winners.push({ draw: drawNumber, ...winner });

        // üéâ Show winner animation
        showWinnerCelebration(winner.name);

        // Remove winner and re-render
        participants.splice(winnerIndex, 1);
        renderWheel();

        spinning = false;
      }
    }, 100);
  }

  function resetAll() {
    participants = [];
    winners = [];
    spinning = false;
    document.getElementById("pasteBox").value = "";
    document.getElementById("wheelItems").innerHTML = "";
    document.getElementById("winnerUl").innerHTML = "";
  }

  function downloadWinners() {
    if (winners.length === 0) { alert("No winners yet!"); return; }

    let csv = "Draw Number,ID,Name,Department,Location\n";
    winners.forEach(w => {
      csv += `${w.draw},${w.id},${w.name},${w.dept},${w.location}\n`;
    });

    const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = `Winners_List.csv`;
    link.click();
  }

  function showWinnerCelebration(name) {
    const celebration = document.getElementById("winnerCelebration");
    const winnerName = document.getElementById("winnerName");
    const confettiContainer = celebration.querySelector(".confetti");

    // Set name
    winnerName.textContent = `üèÜ ${name} üèÜ`;

    // Create confetti particles
    confettiContainer.innerHTML = "";
    for (let i = 0; i < 60; i++) {
      const conf = document.createElement("div");
      conf.classList.add("conf");
      conf.style.left = Math.random() * 100 + "%";
      conf.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 60%)`;
      conf.style.animation = `fall ${1 + Math.random() * 2}s ease-out forwards`;
      conf.style.width = conf.style.height = `${5 + Math.random() * 5}px`;
      confettiContainer.appendChild(conf);
    }

    // Add animation keyframes dynamically
    const style = document.createElement("style");
    style.innerHTML = `
      @keyframes fall {
        0% { transform: translateY(0) rotate(0deg); opacity: 1; }
        100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
      }
      .conf {
        position: absolute;
        top: -10px;
        border-radius: 50%;
      }
    `;
    document.head.appendChild(style);

    // Show celebration
    celebration.classList.remove("hidden");

    // Hide celebration after 3 seconds
    setTimeout(() => {
      celebration.classList.add("hidden");
    }, 4000);
  }
</script>

</body>
</html>
